DROP TABLE IF EXISTS users;

CREATE TABLE users (
  id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  real_name TEXT NOT NULL,
  email_address TEXT NOT NULL,
  username TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL
);

DROP TYPE IF EXISTS visibility;

CREATE TYPE visibility AS ENUM ('public', 'private');

DROP TABLE IF EXISTS notes;

CREATE TABLE notes (
  id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  owner_id INTEGER REFERENCES users(id) ON DELETE CASCADE NOT NULL,
  body TEXT NOT NULL,
  visibility visibility NOT NULL
);
